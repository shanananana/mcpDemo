# 开发规范

## 分层约定
- controller：仅处理请求映射、参数绑定、统一返回，禁止写业务逻辑
- service：承载业务逻辑，对外可通过 `@Tool` 暴露为 MCP 工具
- config：仅放置配置与 Bean 定义

## 命名规范
 
- 变量名：具备语义，避免缩写，如 `cityName`

## 代码风格
- 避免深层嵌套，优先早返回
- Null 安全优先，参数校验在入口完成
- 日志使用 SLF4J，禁止 `System.out.println`

## 控制器规范
- `@RestController` + `@RequestMapping` 定义前缀
- 入参：`@RequestParam`/`@PathVariable`/`@RequestBody`
- 出参：统一为可序列化的 DTO/Map

## Service 规范
- 单一职责，面向接口/领域
- MCP 工具方法需添加 `@Tool` 与 `@ToolParam`

## 异常与返回
- 明确异常边界，向上抛出业务异常或统一异常处理
- 返回结构包含必要的 `status`/`message`/`timestamp`

## 其他
- 单元测试命名：`*Tests`
- 配置项放 `application.yml`，严禁硬编码敏感信息

## 新增：文档与二进制生成下载接口规范

- 生成接口：`POST /{domain}/generate-*`，请求体为对象。
- 下载接口：`GET /{domain}/download?fileId=...`，以 `attachment` 方式返回。
- 文件存储路径：`data/{domain}s/`，文件名包含 `title` 的 slug 与 `fileId`。

### Excel

- `POST /excel/generate-xlsx`：
  - `title`：用于文件名
  - `sheetName`：工作表名
  - `headers`：列头数组（顺序即列顺序）
  - `rows`：数组，每个元素为键值映射，键需与列头对应

### PPT

- `POST /ppt/generate-pptx`：
  - `title`：用于文件名
  - `slides`：数组，每个元素包含 `heading`、`text`

## MCP 客户端建议

- 通过 `/api/mcp/tools` 自动发现工具与真实路径。
- 为复杂请求准备 JSON 示例，便于直接调用。